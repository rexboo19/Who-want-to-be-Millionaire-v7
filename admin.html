<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Millionaire - Question Admin</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-calculator"></i>
                Math Millionaire Admin
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-gamepad"></i> Play Game
                </a>
                <a class="nav-link" href="#" id="export-questions">
                    <i class="fas fa-download"></i> Export
                </a>
                <a class="nav-link" href="#" id="import-questions">
                    <i class="fas fa-upload"></i> Import
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container-fluid mt-4">
        <!-- Tabs Navigation -->
        <ul class="nav nav-tabs mb-4" id="adminTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="questions-tab" data-bs-toggle="tab" data-bs-target="#questions-pane" type="button" role="tab">
                    <i class="fas fa-question-circle"></i> Questions
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="classes-tab" data-bs-toggle="tab" data-bs-target="#classes-pane" type="button" role="tab">
                    <i class="fas fa-users"></i> Classes
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="adminTabContent">
            <!-- Questions Tab -->
            <div class="tab-pane fade show active" id="questions-pane" role="tabpanel">
                <div class="row">
                    <!-- Question Form -->
                    <div class="col-lg-4">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-plus-circle"></i>
                            Add/Edit Question
                        </h5>
                    </div>
                    <div class="card-body">
                        <form id="question-form">
                            <div class="mb-3">
                                <label for="question-text" class="form-label">Question</label>
                                <div class="math-editor-container">
                                    <div class="math-toolbar">
                                        <div class="math-toolbar-section">
                                            <label class="math-toolbar-label">Basic:</label>
                                            <button type="button" class="math-btn" data-symbol="√" title="Square Root">√</button>
                                            <button type="button" class="math-btn" data-symbol="^" title="Power">^</button>
                                            <button type="button" class="math-btn" data-symbol="/" title="Fraction">/</button>
                                            <button type="button" class="math-btn" data-symbol="±" title="Plus/Minus">±</button>
                                            <button type="button" class="math-btn" data-symbol="π" title="Pi">π</button>
                                        </div>
                                        <div class="math-toolbar-section">
                                            <label class="math-toolbar-label">Operators:</label>
                                            <button type="button" class="math-btn" data-symbol="≠" title="Not Equal">≠</button>
                                            <button type="button" class="math-btn" data-symbol="≤" title="Less/Equal">≤</button>
                                            <button type="button" class="math-btn" data-symbol="≥" title="Greater/Equal">≥</button>
                                            <button type="button" class="math-btn" data-symbol="∞" title="Infinity">∞</button>
                                            <button type="button" class="math-btn" data-symbol="∑" title="Sum">∑</button>
                                        </div>
                                        <div class="math-toolbar-section">
                                            <label class="math-toolbar-label">Greek:</label>
                                            <button type="button" class="math-btn" data-symbol="α" title="Alpha">α</button>
                                            <button type="button" class="math-btn" data-symbol="β" title="Beta">β</button>
                                            <button type="button" class="math-btn" data-symbol="γ" title="Gamma">γ</button>
                                            <button type="button" class="math-btn" data-symbol="δ" title="Delta">δ</button>
                                            <button type="button" class="math-btn" data-symbol="θ" title="Theta">θ</button>
                                        </div>
                                        <div class="math-toolbar-section">
                                            <label class="math-toolbar-label">Calculus:</label>
                                            <button type="button" class="math-btn" data-symbol="∫" title="Integral">∫</button>
                                            <button type="button" class="math-btn" data-symbol="∂" title="Partial">∂</button>
                                            <button type="button" class="math-btn" data-symbol="lim" title="Limit">lim</button>
                                            <button type="button" class="math-btn" data-symbol="→" title="Arrow">→</button>
                                        </div>
                                    </div>
                                    <textarea class="form-control" id="question-text" rows="3" 
                                        placeholder="Enter your math question here... Click symbols above to insert them." required></textarea>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="question-image" class="form-label">Question Image (Optional)</label>
                                <input type="file" class="form-control" id="question-image" accept="image/*">
                                <div class="form-text">Upload an image to accompany your question (JPG, PNG, GIF)</div>
                                <div id="image-preview" class="mt-2" style="display: none;">
                                    <img id="preview-img" src="" alt="Preview" class="img-thumbnail" style="max-width: 200px; max-height: 200px;">
                                    <button type="button" class="btn btn-sm btn-danger ms-2" id="remove-image">Remove Image</button>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="topic" class="form-label">Topic</label>
                                <div class="input-group">
                                    <select class="form-select" id="topic" required>
                                        <option value="">Select or create a topic...</option>
                                    </select>
                                    <button class="btn btn-outline-primary" type="button" id="add-topic-btn">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="option-a" class="form-label">Option A</label>
                                <div class="math-input-container">
                                    <div class="math-toolbar-small">
                                        <button type="button" class="math-btn-small" data-symbol="√" data-target="option-a">√</button>
                                        <button type="button" class="math-btn-small" data-symbol="^" data-target="option-a">^</button>
                                        <button type="button" class="math-btn-small" data-symbol="/" data-target="option-a">/</button>
                                        <button type="button" class="math-btn-small" data-symbol="±" data-target="option-a">±</button>
                                        <button type="button" class="math-btn-small" data-symbol="π" data-target="option-a">π</button>
                                        <button type="button" class="math-btn-small" data-symbol="≠" data-target="option-a">≠</button>
                                        <button type="button" class="math-btn-small" data-symbol="≤" data-target="option-a">≤</button>
                                        <button type="button" class="math-btn-small" data-symbol="≥" data-target="option-a">≥</button>
                                    </div>
                                    <input type="text" class="form-control" id="option-a" placeholder="First option" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="option-b" class="form-label">Option B</label>
                                <div class="math-input-container">
                                    <div class="math-toolbar-small">
                                        <button type="button" class="math-btn-small" data-symbol="√" data-target="option-b">√</button>
                                        <button type="button" class="math-btn-small" data-symbol="^" data-target="option-b">^</button>
                                        <button type="button" class="math-btn-small" data-symbol="/" data-target="option-b">/</button>
                                        <button type="button" class="math-btn-small" data-symbol="±" data-target="option-b">±</button>
                                        <button type="button" class="math-btn-small" data-symbol="π" data-target="option-b">π</button>
                                        <button type="button" class="math-btn-small" data-symbol="≠" data-target="option-b">≠</button>
                                        <button type="button" class="math-btn-small" data-symbol="≤" data-target="option-b">≤</button>
                                        <button type="button" class="math-btn-small" data-symbol="≥" data-target="option-b">≥</button>
                                    </div>
                                    <input type="text" class="form-control" id="option-b" placeholder="Second option" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="option-c" class="form-label">Option C</label>
                                <div class="math-input-container">
                                    <div class="math-toolbar-small">
                                        <button type="button" class="math-btn-small" data-symbol="√" data-target="option-c">√</button>
                                        <button type="button" class="math-btn-small" data-symbol="^" data-target="option-c">^</button>
                                        <button type="button" class="math-btn-small" data-symbol="/" data-target="option-c">/</button>
                                        <button type="button" class="math-btn-small" data-symbol="±" data-target="option-c">±</button>
                                        <button type="button" class="math-btn-small" data-symbol="π" data-target="option-c">π</button>
                                        <button type="button" class="math-btn-small" data-symbol="≠" data-target="option-c">≠</button>
                                        <button type="button" class="math-btn-small" data-symbol="≤" data-target="option-c">≤</button>
                                        <button type="button" class="math-btn-small" data-symbol="≥" data-target="option-c">≥</button>
                                    </div>
                                    <input type="text" class="form-control" id="option-c" placeholder="Third option" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="option-d" class="form-label">Option D</label>
                                <div class="math-input-container">
                                    <div class="math-toolbar-small">
                                        <button type="button" class="math-btn-small" data-symbol="√" data-target="option-d">√</button>
                                        <button type="button" class="math-btn-small" data-symbol="^" data-target="option-d">^</button>
                                        <button type="button" class="math-btn-small" data-symbol="/" data-target="option-d">/</button>
                                        <button type="button" class="math-btn-small" data-symbol="±" data-target="option-d">±</button>
                                        <button type="button" class="math-btn-small" data-symbol="π" data-target="option-d">π</button>
                                        <button type="button" class="math-btn-small" data-symbol="≠" data-target="option-d">≠</button>
                                        <button type="button" class="math-btn-small" data-symbol="≤" data-target="option-d">≤</button>
                                        <button type="button" class="math-btn-small" data-symbol="≥" data-target="option-d">≥</button>
                                    </div>
                                    <input type="text" class="form-control" id="option-d" placeholder="Fourth option" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="correct-answer" class="form-label">Correct Answer</label>
                                <select class="form-select" id="correct-answer" required>
                                    <option value="0">A</option>
                                    <option value="1">B</option>
                                    <option value="2">C</option>
                                    <option value="3">D</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="explanation" class="form-label">Explanation (Optional)</label>
                                <textarea class="form-control" id="explanation" rows="2" 
                                    placeholder="Explain the solution or provide hints..."></textarea>
                            </div>
                            
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-success" id="save-question">
                                    <i class="fas fa-save"></i> Save Question
                                </button>
                                <button type="button" class="btn btn-secondary" id="clear-form">
                                    <i class="fas fa-eraser"></i> Clear Form
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="card mt-3">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-bolt"></i>
                            Quick Actions
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary" id="load-default-questions">
                                <i class="fas fa-database"></i> Load Default Questions
                            </button>
                            <button class="btn btn-outline-warning" id="clear-all-questions">
                                <i class="fas fa-trash"></i> Clear All Questions
                            </button>
                            <button class="btn btn-outline-info" id="preview-game">
                                <i class="fas fa-eye"></i> Preview Game
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Class Management Section -->
                <div class="card mt-3">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-users"></i>
                            Manage Classes
                        </h6>
                    </div>
                    <div class="card-body">
                        <form id="class-form">
                            <div class="mb-3">
                                <label for="class-name" class="form-label fw-bold">Add New Class</label>
                                <input type="text" class="form-control" id="class-name" 
                                    placeholder="e.g., Math 101, Grade 5A..." required>
                                <div class="form-text small">Class names for audience members to select</div>
                            </div>
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i> Add Class
                                </button>
                            </div>
                        </form>
                        
                        <hr class="my-3">
                        
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="mb-0">Class List</h6>
                            <span class="badge bg-secondary" id="class-count">0 classes</span>
                        </div>
                        <div id="classes-list" class="classes-container" style="max-height: 300px; overflow-y: auto;">
                            <!-- Classes will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Questions List -->
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-list"></i>
                            Questions Library
                        </h5>
                        <span class="badge bg-light text-dark" id="question-count">0 questions</span>
                    </div>
                    <div class="card-body">
                        <!-- Search and Filter -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <input type="text" class="form-control" id="search-questions" 
                                    placeholder="Search questions...">
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="filter-topic">
                                    <option value="">All Topics</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-primary w-100" id="sort-questions">
                                    <i class="fas fa-sort"></i> Sort by Topic
                                </button>
                            </div>
                        </div>
                        
                        <!-- Questions List -->
                        <div id="questions-list" class="questions-container">
                            <!-- Questions will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Questions Tab -->

            <!-- Classes Tab -->
            <div class="tab-pane fade" id="classes-pane" role="tabpanel" aria-labelledby="classes-tab" style="display: none;">
                <div class="row mt-3">
                    <div class="col-lg-6">
                        <div class="card shadow-sm">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-plus-circle"></i>
                                    Add New Class
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="class-form">
                                    <div class="mb-3">
                                        <label for="class-name" class="form-label fw-bold">Class Name</label>
                                        <input type="text" class="form-control form-control-lg" id="class-name" 
                                            placeholder="e.g., Math 101, Grade 5A, Algebra Class..." required autofocus>
                                        <div class="form-text">Enter a unique class name that students will see when joining as audience.</div>
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button type="submit" class="btn btn-success btn-lg">
                                            <i class="fas fa-save"></i> Add Class
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="card shadow-sm">
                            <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-list"></i>
                                    Class List
                                </h5>
                                <span class="badge bg-light text-dark" id="class-count">0 classes</span>
                            </div>
                            <div class="card-body">
                                <div id="classes-list" class="classes-container">
                                    <!-- Classes will be dynamically loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Classes Tab -->
        </div>
        <!-- End Tab Content -->
    </div>

    <!-- Import Modal -->
    <div class="modal fade" id="importModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Import Questions</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="import-file" class="form-label">Select JSON file</label>
                        <input type="file" class="form-control" id="import-file" accept=".json">
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        Import a JSON file with questions. Format: array of question objects with question, options, correct, difficulty properties.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirm-import">Import</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Question Preview Modal -->
    <div class="modal fade" id="previewModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Question Preview</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="preview-content">
                    <!-- Preview content will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Topic Modal -->
    <div class="modal fade" id="addTopicModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Topic</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="new-topic-name" class="form-label">Topic Name</label>
                        <input type="text" class="form-control" id="new-topic-name" 
                            placeholder="e.g., Algebra, Geometry, Calculus..." required>
                    </div>
                    <div class="mb-3">
                        <label for="new-topic-description" class="form-label">Description (Optional)</label>
                        <textarea class="form-control" id="new-topic-description" rows="2" 
                            placeholder="Brief description of this topic..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-topic">Add Topic</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MathJax for mathematical notation -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>
    <!-- Firebase Helper -->
    <script src="firebase-helper.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="admin-script.js"></script>
</body>
</html>
